def rgb_to_ycbcr(r,g,b)
# from wikipedia YCbCr JPEG section
	return 0.299 * r + 0.587 *g + 0.114 *b,128 -(0.168736*r) -(0.331264*g) +(0.5 * b),128+(0.5*r)-(0.418688*g) - (0.081312*b)
end

def ycbcr_to_rgb(y,cb,cr)
	# from wikipedia YCbCr JPEG section
	 rf = y  + 1.402*(cr-128)
	 gf = y-0.34414*(cb-128)- 0.71414*(cr-128)
	 bf = y+1.772* (cb-128)
	 return rf.to_i,gf.to_i, bf.to_i
end

 
 def rgb_ovt(r,g,b)
   rf = 1.640076 * r -0.570061 * g  -0.0700015 * b
   gf = -0.388791 *r + 1.873172 * g -0.484381 * b
   bf = -0.16169 *r -1.133188 * g + 2.294878 * b
   return rf.to_i,gf.to_i, bf.to_i  
 end
 
 def cap_0_255(ia)  
   i = ia.to_i 
   i = i> 255? 255:i
   i = i<0 ? 0: i
   return i.to_i
end

 
gamma_array_22= [
0,  
21, 
28, 
34, 
39, 
43, 
47, 
50, 
53, 
56, 
59, 
61, 
64, 
66, 
69, 
71, 
73, 
75, 
77, 
79, 
81, 
82, 
84, 
86, 
88, 
89, 
91, 
92, 
94, 
95, 
97, 
98, 
100,
101,
102,
104,
105,
106,
108,
109,
110,
112,
113,
114,
115,
116,
117,
119,
120,
121,
122,
123,
124,
125,
126,
127,
128,
129,
130,
131,
132,
133,
134,
135,
136,
137,
138,
139,
140,
141,
142,
143,
144,
145,
146,
147,
147,
148,
149,
150,
151,
152,
153,
153,
154,
155,
156,
157,
157,
158,
159,
160,
161,
161,
162,
163,
164,
165,
165,
166,
167,
168,
168,
169,
170,
171,
171,
172,
173,
173,
174,
175,
176,
176,
177,
178,
178,
179,
180,
180,
181,
182,
183,
183,
184,
185,
185,
186,
186,
187,
188,
188,
189,
190,
190,
191,
192,
192,
193,
194,
194,
195,
195,
196,
197,
197,
198,
199,
199,
200,
200,
201,
202,
202,
203,
203,
204,
204,
205,
206,
206,
207,
207,
208,
209,
209,
210,
210,
211,
211,
212,
213,
213,
214,
214,
215,
215,
216,
216,
217,
218,
218,
219,
219,
220,
220,
221,
221,
222,
222,
223,
223,
224,
224,
225,
226,
226,
227,
227,
228,
228,
229,
229,
230,
230,
231,
231,
232,
232,
233,
233,
234,
234,
235,
235,
236,
236,
237,
237,
238,
238,
239,
239,
240,
240,
241,
241,
241,
242,
242,
243,
243,
244,
244,
245,
245,
246,
246,
247,
247,
248,
248,
249,
249,
249,
250,
250,
251,
251,
252,
252,
253,
253,
254,
254,
255]

gamma_array=[0, 
1, 
3, 
5, 
7, 
8, 
10, 
12,
14,
15,
17,
19,
21,
22,
24,
26,
28,
29,
31,
32,
34,
35,
37,
38,
40,
42,
43,
45,
46,
48,
49,
51,
53,
54,
56,
57,
59,
61,
62,
64,
66,
67,
69,
70,
72,
74,
75,
77,
79,
80,
82,
83,
85,
86,
88,
89,
91,
92,
94,
95,
97,
98,
100,
101,
103,
104,
106,
107,
109,
111,
112,
114,
116,
117,
118,
120,
121,
122,
124,
125,
127,
128,
129,
131,
132,
134,
135,
137,
138,
139,
141,
142,
144,
145,
147,
148,
150,
151,
152,
153,
155,
156,
157,
159,
160,
161,
163,
164,
165,
167,
168,
169,
171,
172,
173,
174,
175,
176,
178,
179,
180,
181,
182,
184,
185,
186,
187,
188,
190,
191,
192,
193,
194,
195,
197,
198,
199,
200,
201,
203,
204,
205,
206,
207,
209,
209,
210,
211,
212,
212,
213,
214,
215,
216,
216,
217,
218,
219,
219,
220,
221,
222,
223,
223,
224,
225,
226,
226,
227,
228,
229,
230,
230,
231,
232,
233,
234,
234,
234,
235,
235,
236,
236,
237,
237,
237,
238,
238,
239,
239,
240,
240,
241,
241,
241,
242,
242,
243,
243,
244,
244,
244,
245,
245,
246,
246,
247,
247,
248,
248,
248,
248,
248,
248,
248,
249,
249,
249,
249,
249,
249,
249,
250,
250,
250,
250,
250,
250,
250,
251,
251,
251,
251,
251,
251,
252,
252,
252,
252,
252,
252,
252,
253,
253,
253,
253,
253,
253,
253,
254,
254,
254,
254,
254,
254,
255,
]

aFile = File.new("testfile.raw", "wb")
for y1 in 0..5
	for y2 in 0..32
		for y3 in 0..9
			for x1 in 0..6
				for x2 in 0..32
					# write 10 pixels. last two dark
					# so y2 is r, x2 is b, y1, x1+y1 = g - use 8 bit increments
					g = (x1 +y1*7)*8 
				    if g> 255 then
						g=255
					end
					b = x2*8
					if b> 255 then
						b=255
					end
					r = y2*8
					if r> 255 then
						r=255
					end	
					#optional gamma lut
					r = gamma_array[r]
					g = gamma_array[g]
					b = gamma_array[b]
			        # optional convert to and from yuv
					#	tp1 = rgb_to_ycbcr(r,g,b)
					#	tp2 = ycbcr_to_rgb( tp1[0], tp1[1], tp1[2])
					#	r=tp2[0]; g=tp2[1]; b=tp2[2]
					
					#  optional do OVT transform - RGB - capped
					#tp1 = rgb_ovt(r,g,b)
					#r=cap_0_255(tp1[0])
					#g=cap_0_255(tp1[1])
					#b=cap_0_255(tp1[2])
					
					# optional - r = ovtr > yuv > out yuv					
					tp1 = rgb_ovt(r,g,b)
					tp2 = rgb_to_ycbcr(tp1[0],tp1[1],tp1[2])
					tp3 = ycbcr_to_rgb( tp2[0], tp2[1], tp2[2])
					r=cap_0_255(tp3[0])
					g=cap_0_255(tp3[1])
					b=cap_0_255(tp3[2])
					
					# first row is bgbgbgbg 
					# second is grgrgrgr 
					bval = [b].pack('c')
					gval = [g].pack('c')
					rval = [r].pack('c')
					
					if (y3 % 2 == 0) then
						5.times {aFile.syswrite(bval) ;aFile.syswrite(gval) }
					else
						5.times {aFile.syswrite(gval) ;aFile.syswrite(rval) }					
					end
				
				end
			end
			# write 2592-1952 at end of line
			buf2 = [200].pack('c')
			(2592-7*33*10).times {aFile.syswrite(buf2)}
		end
	end
end
# write 1944-1930 lines at end of line
buf3 = [240].pack('c')
(2592*(1944-6*33*10)).times {aFile.syswrite(buf3)}
aFile.close


 